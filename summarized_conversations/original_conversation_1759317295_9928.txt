{'role': 'assistant', 'content': '## Starting Phase 2: Epic-Specific Features Implementation\n\nI\'ll now begin implementing Epic-specific features to maximize data extraction from Epic\'s MyChart FHIR API. Let me start with the database schema updates and then move to the service implementations.\n\n### Step 1: Database Schema Updates\n\n\n<function_calls>\n<str-replace file_path="prisma/schema.prisma">\n<old_str>model SyncHistory {\n  id            String   @id @default(cuid())\n  connectionId  String\n  connection    EHRConnection @relation(fields: [connectionId], references: [id], onDelete: Cascade)\n  status        SyncStatus\n  startedAt     DateTime @default(now())\n  completedAt   DateTime?\n  resourceCount Int      @default(0)\n  errorMessage  String?\n  metadata      Json?\n  \n  @@index([connectionId])\n  @@index([status])\n  @@index([startedAt])\n  @@map("sync_history")\n}</old_str>\n<new_str>model SyncHistory {\n  id            String   @id @default(cuid())\n  connectionId  String\n  connection    EHRConnection @relation(fields: [connectionId], references: [id], onDelete: Cascade)\n  status        SyncStatus\n  startedAt     DateTime @default(now())\n  completedAt   DateTime?\n  resourceCount Int      @default(0)\n  errorMessage  String?\n  metadata      Json?\n  \n  @@index([connectionId])\n  @@index([status])\n  @@index([startedAt])\n  @@map("sync_history")\n}\n\nmodel BulkExportJob {\n  id              String   @id @default(cuid())\n  connectionId    String\n  connection      EHRConnection @relation(fields: [connectionId], references: [id], onDelete: Cascade)\n  exportType      BulkExportType\n  status          BulkExportStatus\n  kickoffUrl      String?\n  statusUrl       String?\n  outputUrls      Json?\n  errorMessage    String?\n  resourceTypes   Json?\n  since           DateTime?\n  startedAt       DateTime @default(now())\n  completedAt     DateTime?\n  expiresAt       DateTime?\n  resourceCount   Int      @default(0)\n  totalSize       BigInt   @default(0)\n  metadata        Json?\n  \n  @@index([connectionId])\n  @@index([status])\n  @@index([startedAt])\n  @@map("bulk_export_jobs")\n}\n\nmodel EpicSpecificData {\n  id              String   @id @default(cuid())\n  resourceId      String   @unique\n  resource        FHIRResource @relation(fields: [resourceId], references: [id], onDelete: Cascade)\n  extensions      Json?\n  customFields    Json?\n  metadata        Json?\n  createdAt       DateTime @default(now())\n  updatedAt       DateTime @updatedAt\n  \n  @@index([resourceId])\n  @@map("epic_specific_data")\n}\n\nenum BulkExportType {\n  PATIENT\n  GROUP\n  SYSTEM\n}\n\nenum BulkExportStatus {\n  INITIATED\n  IN_PROGRESS\n  COMPLETED\n  FAILED\n  EXPIRED\n  CANCELLED\n}</new_str>\n</str-replace>\n</function_calls>\n</function_calls>'}