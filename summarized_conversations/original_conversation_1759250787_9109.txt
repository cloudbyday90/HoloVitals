{'role': 'assistant', 'content': '\n<function_calls>\n<create-file file_path="medical-analysis-platform/app/dashboard/analyze/[id]/page.tsx">\n\'use client\';\n\nimport { useState } from \'react\';\nimport { useParams } from \'next/navigation\';\nimport { ChatInterface } from \'@/components/analysis/chat-interface\';\nimport { Card, CardContent, CardHeader, CardTitle } from \'@/components/ui/card\';\nimport { Button } from \'@/components/ui/button\';\nimport { ArrowLeft, FileText, Calendar, Tag } from \'lucide-react\';\nimport Link from \'next/link\';\n\nexport default function AnalyzePage() {\n  const params = useParams();\n  const documentId = params.id as string;\n\n  // Mock document data - in production, this would be fetched from API\n  const document = {\n    id: documentId,\n    fileName: \'Bloodwork_Results_2024.pdf\',\n    documentType: \'bloodwork\',\n    documentDate: new Date(\'2024-01-15\'),\n    status: \'completed\',\n    extractedData: [\n      { name: \'Hemoglobin\', value: \'14.5\', unit: \'g/dL\', range: \'13.5-17.5\', isAbnormal: false },\n      { name: \'WBC\', value: \'12.5\', unit: \'K/uL\', range: \'4.5-11.0\', isAbnormal: true },\n      { name: \'Platelets\', value: \'250\', unit: \'K/uL\', range: \'150-400\', isAbnormal: false },\n      { name: \'Glucose\', value: \'105\', unit: \'mg/dL\', range: \'70-100\', isAbnormal: true },\n    ]\n  };\n\n  const handleSendMessage = async (message: string): Promise<string> => {\n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 1500));\n    \n    // Mock response based on message content\n    if (message.toLowerCase().includes(\'abnormal\')) {\n      return `Based on the analysis of ${document.fileName}, I found 2 abnormal values:\n\n1. **WBC (White Blood Cell Count)**: 12.5 K/uL\n   - Reference range: 4.5-11.0 K/uL\n   - Status: Elevated\n   - This could indicate an infection or inflammatory response. It\'s recommended to discuss this with your healthcare provider.\n\n2. **Glucose**: 105 mg/dL\n   - Reference range: 70-100 mg/dL\n   - Status: Slightly elevated\n   - This is just above the normal range. Consider discussing fasting glucose levels and potential pre-diabetes screening with your doctor.\n\n**Important Note**: These findings should be discussed with your healthcare provider for proper medical interpretation and follow-up.`;\n    }\n    \n    if (message.toLowerCase().includes(\'trend\') || message.toLowerCase().includes(\'compare\')) {\n      return `To provide a comprehensive trend analysis, I would need access to your previous bloodwork results. \n\nBased on the current document (${document.documentDate.toLocaleDateString()}), here\'s what I can tell you:\n\n- Your hemoglobin levels are within normal range\n- WBC count is elevated, which may warrant monitoring\n- Platelet count is healthy\n- Glucose is slightly elevated\n\nIf you upload previous test results, I can:\n- Track changes over time\n- Identify improving or worsening trends\n- Highlight significant variations\n- Provide context for current values\n\nWould you like to upload previous results for comparison?`;\n    }\n    \n    return `I\'ve analyzed ${document.fileName} from ${document.documentDate.toLocaleDateString()}. \n\nThis document contains ${document.extractedData.length} test results. Here\'s a summary:\n\n${document.extractedData.map(item => \n  `- ${item.name}: ${item.value} ${item.unit} (Range: ${item.range}) ${item.isAbnormal ? \'⚠️ ABNORMAL\' : \'✓ Normal\'}`\n).join(\'\\n\')}\n\nYou can ask me specific questions about:\n- Individual test results\n- Abnormal values and their implications\n- Comparisons with previous tests\n- General health insights\n\nWhat would you like to know more about?`;\n  };\n\n  return (\n    <div className="min-h-screen bg-gray-50">\n      {/* Header */}\n      <div className="bg-white border-b">\n        <div className="container mx-auto px-4 py-6">\n          <Link href="/dashboard">\n            <Button variant="ghost" className="mb-4">\n              <ArrowLeft className="w-4 h-4 mr-2" />\n              Back to Dashboard\n            </Button>\n          </Link>\n          <h1 className="text-3xl font-bold">Document Analysis</h1>\n          <p className="text-gray-600 mt-2">\n            AI-powered analysis and insights\n          </p>\n        </div>\n      </div>\n\n      <div className="container mx-auto px-4 py-8">\n        <div className="grid lg:grid-cols-3 gap-6">\n          {/* Document Info Sidebar */}\n          <div className="lg:col-span-1">\n            <Card>\n              <CardHeader>\n                <CardTitle>Document Information</CardTitle>\n              </CardHeader>\n              <CardContent className="space-y-4">\n                <div className="flex items-start gap-3">\n                  <FileText className="w-5 h-5 text-gray-600 mt-0.5" />\n                  <div>\n                    <p className="text-sm text-gray-600">File Name</p>\n                    <p className="font-medium">{document.fileName}</p>\n                  </div>\n                </div>\n\n                <div className="flex items-start gap-3">\n                  <Tag className="w-5 h-5 text-gray-600 mt-0.5" />\n                  <div>\n                    <p className="text-sm text-gray-600">Document Type</p>\n                    <p className="font-medium capitalize">{document.documentType}</p>\n                  </div>\n                </div>\n\n                <div className="flex items-start gap-3">\n                  <Calendar className="w-5 h-5 text-gray-600 mt-0.5" />\n                  <div>\n                    <p className="text-sm text-gray-600">Document Date</p>\n                    <p className="font-medium">{document.documentDate.toLocaleDateString()}</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            <Card className="mt-6">\n              <CardHeader>\n                <CardTitle>Extracted Data</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className="space-y-3">\n                  {document.extractedData.map((item, index) => (\n                    <div key={index} className="border-b pb-3 last:border-b-0">\n                      <div className="flex justify-between items-start mb-1">\n                        <span className="font-medium">{item.name}</span>\n                        {item.isAbnormal &amp;&amp; (\n                          <span className="text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded">\n                            Abnormal\n                          </span>\n                        )}\n                      </div>\n                      <p className="text-sm text-gray-600">\n                        {item.value} {item.unit}\n                      </p>\n                      <p className="text-xs text-gray-500">\n                        Range: {item.range}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Chat Interface */}\n          <div className="lg:col-span-2">\n            <ChatInterface\n              documentId={documentId}\n              onSendMessage={handleSendMessage}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n</create-file>\n</function_calls>\n</function_calls>'}