{'role': 'assistant', 'content': '<function_calls>\n<create-file file_path="app/api/ehr/eclinicalworks/enhanced-sync/route.ts">\n/**\n * eClinicalWorks Enhanced Sync API Endpoint\n * \n * POST /api/ehr/eclinicalworks/enhanced-sync - Sync with enhanced features\n */\n\nimport { NextRequest, NextResponse } from \'next/server\';\nimport { getEClinicalWorksEnhancedService } from \'@/lib/services/EClinicalWorksEnhancedService\';\n\nconst service = getEClinicalWorksEnhancedService();\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { connectionId, includeStandard, includeEnhanced, resourceTypes, since } = body;\n\n    if (!connectionId) {\n      return NextResponse.json(\n        { success: false, error: \'connectionId is required\' },\n        { status: 400 }\n      );\n    }\n\n    const result = await service.enhancedSync(connectionId, {\n      includeStandard,\n      includeEnhanced,\n      resourceTypes,\n      since: since ? new Date(since) : undefined,\n    });\n\n    return NextResponse.json({\n      success: true,\n      data: result,\n    });\n  } catch (error: any) {\n    console.error(\'Error performing eClinicalWorks enhanced sync:\', error);\n    return NextResponse.json(\n      { success: false, error: error.message },\n      { status: 500 }\n    );\n  }\n}\n</create-file>\n</function_calls>'}